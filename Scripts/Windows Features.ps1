$DisabledFeatures = $(
	"AppServerClient"
	"Client-DeviceLockdown"
	"Client-EmbeddedBootExp"
	"Client-EmbeddedLogon"
	"Client-EmbeddedShellLauncher"
	"Client-KeyboardFilter"
	"Client-ProjFS"
	"Client-UnifiedWriteFilter"
	"ClientForNFS-Infrastructure"
	"Containers"
	"Containers-DisposableClientVM"
	"DataCenterBridging"
	"DirectoryServices-ADAM-Client"
	"DirectPlay"
	"HostGuardian"
	"HypervisorPlatform"
	"IIS-ApplicationDevelopment"
	"IIS-ApplicationInit"
	"IIS-ASP"
	"IIS-ASPNET"
	"IIS-ASPNET45"
	"IIS-BasicAuthentication"
	"IIS-CertProvider"
	"IIS-CGI"
	"IIS-ClientCertificateMappingAuthentication"
	"IIS-CommonHttpFeatures"
	"IIS-CustomLogging"
	"IIS-DefaultDocument"
	"IIS-DigestAuthentication"
	"IIS-DirectoryBrowsing"
	"IIS-FTPExtensibility"
	"IIS-FTPServer"
	"IIS-FTPSvc"
	"IIS-HealthAndDiagnostics"
	"IIS-HostableWebCore"
	"IIS-HttpCompressionDynamic"
	"IIS-HttpCompressionStatic"
	"IIS-HttpErrors"
	"IIS-HttpLogging"
	"IIS-HttpRedirect"
	"IIS-HttpTracing"
	"IIS-IIS6ManagementCompatibility"
	"IIS-IISCertificateMappingAuthentication"
	"IIS-IPSecurity"
	"IIS-ISAPIExtensions"
	"IIS-ISAPIFilter"
	"IIS-LegacyScripts"
	"IIS-LegacySnapIn"
	"IIS-LoggingLibraries"
	"IIS-ManagementConsole"
	"IIS-ManagementScriptingTools"
	"IIS-ManagementService"
	"IIS-Metabase"
	"IIS-NetFxExtensibility"
	"IIS-NetFxExtensibility45"
	"IIS-ODBCLogging"
	"IIS-Performance"
	"IIS-RequestFiltering"
	"IIS-RequestMonitor"
	"IIS-Security"
	"IIS-ServerSideIncludes"
	"IIS-StaticContent"
	"IIS-URLAuthorization"
	"IIS-WebDAV"
	"IIS-WebServer"
	"IIS-WebServerManagementTools"
	"IIS-WebServerRole"
	"IIS-WebSockets"
	"IIS-WindowsAuthentication"
	"IIS-WMICompatibility"
	"LegacyComponents"
	"Microsoft-Hyper-V"
	"Microsoft-Hyper-V-All"
	"Microsoft-Hyper-V-Hypervisor"
	"Microsoft-Hyper-V-Management-Clients"
	"Microsoft-Hyper-V-Management-PowerShell"
	"Microsoft-Hyper-V-Services"
	"Microsoft-Hyper-V-Tools-All"
	"Microsoft-Windows-Subsystem-Linux"
	"MSMQ-ADIntegration"
	"MSMQ-Container"
	"MSMQ-DCOMProxy"
	"MSMQ-HTTP"
	"MSMQ-Multicast"
	"MSMQ-Server"
	"MSMQ-Triggers"
	"MSRDC-Infrastructure"
	"NFS-Administration"
	"Printing-Foundation-Features"
	"Printing-Foundation-InternetPrinting-Client"
	"Printing-Foundation-LPDPrintService"
	"Printing-Foundation-LPRPortMonitor"
	"Printing-XPSServices-Features"
	"ServicesForNFS-ClientOnly"
	"SimpleTCP"
	"SMB1Protocol"
	"SMB1Protocol-Client"
	"SMB1Protocol-Deprecation"
	"SMB1Protocol-Server"
	"TelnetClient"
	"TFTP"
	"TIFFIFilter"
	"VirtualMachinePlatform"
	"WAS-ConfigurationAPI"
	"WAS-NetFxEnvironment"
	"WAS-ProcessModel"
	"WAS-WindowsActivationService"
	"WCF-HTTP-Activation"
	"WCF-HTTP-Activation45"
	"WCF-MSMQ-Activation45"
	"WCF-NonHTTP-Activation"
	"WCF-Pipe-Activation45"
	"WCF-TCP-Activation45"
	"Windows-Defender-ApplicationGuard"
	"Windows-Defender-Default-Definitions"
	"Windows-Identity-Foundation"
	"WorkFolders-Client"
)

$EnabledFeatures = $(
	"Internet-Explorer-Optional-amd64"
	"MicrosoftWindowsPowerShellV2"
	"MicrosoftWindowsPowerShellV2Root"
	"NetFx3"
	"NetFx4-AdvSrvs"
	"NetFx4Extended-ASPNET45"
	"Printing-PrintToPDFServices-Features"
	"SearchEngine-Client-Package"
	"SmbDirect"
	"WCF-Services45"
	"WCF-TCP-PortSharing45"
)


$index = 1
foreach ($feature in $DisabledFeatures)
{
	Write-Host "($index/$($DisabledFeatures.Count)) Disabling feature $feature"
	dism /Online /Disable-Feature /FeatureName:$feature /NoRestart /Quiet
	$index++
}

$index = 1
foreach ($feature in $EnabledFeatures)
{
	Write-Host "($index/$($EnabledFeatures.Count)) Enabling feature $feature"
	dism /Online /Enable-Feature /FeatureName:$feature /NoRestart /Quiet
	$index++
}